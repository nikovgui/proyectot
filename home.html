<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <title>OGKicks - Tienda de Zapatillas</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
        }

        .container-fluid {
            display: flex;
        }

        .filter-panel {
            width: 250px;
            padding: 15px;
            border-right: 1px solid #ddd;
            background: #f9f9f9;
        }

        .filter-panel h4 {
            margin-bottom: 15px;
        }

        .sneaker-container {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 15px;
            padding: 20px;
            flex-grow: 1;
        }

        .sneaker {
            border: 1px solid #ddd;
            padding: 10px;
            border-radius: 8px;
            transition: transform 0.2s;
            text-align: center;
            background: #fff;
        }

        .sneaker img {
            width: 120px;
            height: 120px;
            object-fit: cover;
            cursor: pointer;
            border-radius: 5px;
        }

        .sneaker:hover {
            transform: scale(1.08);
        }
    </style>
</head>
<body>

    <!-- Navbar -->
    <nav class="navbar navbar-expand-lg bg-body-tertiary">
        <div class="container-fluid">
            <a class="navbar-brand" href="#">OGKicks</a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarSupportedContent">
                <ul class="navbar-nav me-auto mb-2 mb-lg-0">
                    <li class="nav-item"><a class="nav-link active" href="#">Home</a></li>
                    <li class="nav-item"><a class="nav-link" href="#">Link</a></li>
                    <li class="nav-item"><a class="nav-link disabled" aria-disabled="true">Disabled</a></li>
                </ul>
                <!-- 🔍 Input de búsqueda en el navbar -->
                <form class="d-flex" role="search">
                    <input class="form-control me-2" type="search" id="navbar-search" placeholder="Buscar zapatillas..." onkeyup="filtrarZapatillas()">
                </form>
            </div>
        </div>
    </nav>
    <!-- Navbar -->

    <div class="container-fluid">
        <!-- Panel de filtros -->
        <div class="filter-panel">
            <h4>Filtrar por:</h4>
            
            <!-- Filtro de Marca -->
            <label for="brand-filter">Marca:</label>
            <select id="brand-filter" class="form-select" onchange="filtrarZapatillas()">
                <option value="">Todas</option>
                <option value="Nike">Nike</option>
                <option value="Jordan">Jordan</option>
                <option value="Adidas">Adidas</option>
            </select>

            <!-- Filtro de Talla -->
            <label for="size-filter" class="mt-2">Talla:</label>
            <select id="size-filter" class="form-select" onchange="filtrarZapatillas()">
                <option value="">Todas</option>
                <option value="6">6 US</option>
                <option value="7">7 US</option>
                <option value="8">8 US</option>
                <option value="9">9 US</option>
                <option value="10">10 US</option>
            </select>

            <!-- Filtro de Precio -->
           <label for="price-filter" class="mt-2">Precio Máximo:</label>
            <input type="number" id ="price-filter" class="form-control" placeholder="Ej: 200" onkeyup="filtrarZapatillas()">
        </div>

        <!-- Contenedor de zapatillas -->
        <div class="sneaker-container" id="sneaker-list"></div>
    </div>

    <script>
      let sneakersData = [];
  
      document.addEventListener("DOMContentLoaded", function () {
          fetch("http://localhost/get_sneakers.php")
              .then(response => response.json())
              .then(data => {
                  sneakersData = data.map(sneaker => ({
                      ...sneaker,
                      brand: inferirMarca(sneaker.name) 
                  }));
                  console.log("Datos cargados con marcas inferidas:", sneakersData);
                  renderizarZapatillas(sneakersData);
              })
              .catch(error => {
                  console.error("Error cargando zapatillas:", error);
                  document.getElementById("sneaker-list").innerHTML = `<p>No se pudieron cargar las zapatillas.</p>`;
              });
      });
  
      function inferirMarca(nombre) {
          if (nombre.toLowerCase().includes("jordan")) return "jordan";
          if (nombre.toLowerCase().includes("adidas") || nombre.toLowerCase().includes("yeezy")) return "adidas";
          if (nombre.toLowerCase().includes("nike")) return "nike";
          return "otros"; 
      }
  
      function renderizarZapatillas(data) {
          const container = document.getElementById("sneaker-list");
          container.innerHTML = ""; 
  
          if (data.length === 0) {
              container.innerHTML = "<p>No se encontraron zapatillas.</p>";
              return;
          }
  
          data.forEach(sneaker => {
              const sneakerDiv = document.createElement("div");
              sneakerDiv.classList.add("sneaker");
  
              const imageSrc = sneaker.images && sneaker.images.length > 0 ? sneaker.images[0] : "placeholder.jpg";
              const price = sneaker.prices && sneaker.prices["7"] ? `$${sneaker.prices["7"]}` : "No disponible";
              const brand = sneaker.brand ? sneaker.brand : "Desconocida";
  
              sneakerDiv.innerHTML = `
                  <h3>${sneaker.name}</h3>
                  <a href="detallezapatilla.html?id=${sneaker.id}">
                      <img src="${imageSrc}" alt="${sneaker.name}">
                  </a>
                  <p>Marca: ${brand}</p>*
                  <p>Precio: ${price}</p>
              `;
  
              container.appendChild(sneakerDiv);
          });
      }
  
      function filtrarZapatillas() {
          const searchText = document.getElementById("navbar-search").value.toLowerCase().trim();
          const selectedBrand = document.getElementById("brand-filter").value.toLowerCase().trim();
          const selectedSize = document.getElementById("size-filter").value;
          const maxPrice = document.getElementById("price-filter").value;
  
          console.log("Marca seleccionada:", selectedBrand); 
  
          const filteredData = sneakersData.filter(sneaker => {
              let matchesSearch = sneaker.name.toLowerCase().includes(searchText);
              let matchesBrand = selectedBrand ? sneaker.brand.toLowerCase() === selectedBrand : true;
              let matchesSize = selectedSize ? sneaker.prices[selectedSize] !== undefined : true;
              let matchesPrice = maxPrice ? (sneaker.prices[selectedSize] <= maxPrice) : true;
  
              return matchesSearch && matchesBrand && matchesSize && matchesPrice;
          });
  
          console.log("Zapatillas después de filtrar:", filteredData);
          renderizarZapatillas(filteredData);
      }
  </script>
  
  

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
